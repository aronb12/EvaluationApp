function createEvaluation(a,b,c,d,e){return{ID:a,TitleIS:b,TitleEN:c,IntroTextIS:d,IntroTextEN:e,CourseQuestions:[],TeacherQuestions:[]}}function createQuestion(a,b,c,d,e){return{ID:a,TextIS:b,TextEN:c,ImageURL:d,Type:e,Answers:[]}}function generateEvaluations(){for(var a=[],b=0;5>b;++b){for(var c=b+1,d=createEvaluation(b,"Kennslumat "+c,"Evaluation "+c,"Derp","Derp"),e=0;3>e;++e){var f=e+1,g=createQuestion(e,"Hva√∞ er derp"+f+"?","What is derp "+f+"?","","single");d.CourseQuestions.push(g)}a.push(d)}return a}var app=angular.module("EvaluationApp",["ngRoute"]);app.config(function(a){a.when("/",{templateUrl:"templates/login.html",controller:"LoginController"}).when("/admin",{templateUrl:"templates/admin.html",controller:"AdminController"}).when("/home",{templateUrl:"templates/home.html",controller:"HomeController"}).when("/evaluation/:evaluationID",{templateUrl:"templates/evaluation.html",controller:"EvaluationController"}).when("/evaluation/",{templateUrl:"templates/evaluation.html",controller:"EvaluationController"}).otherwise({redirectTo:"/"})}),app.factory("ApiFactory",["$q",function(a){var b=generateEvaluations();return{getAllEvaluations:function(){var c=a.defer();return c.resolve(b),c.promise},getEvaluationById:function(c){var d=a.defer();return b[c]?d.resolve(b[c]):d.reject("No evaluation with this id"),d.promise},addEvaluation:function(){var b=a.defer();return b.promise}}}]),app.factory("LoginFactory",["$http","$q",function(a,b){var c,d={};return{login:function(e,f){var g=b.defer();return a.post("http://dispatch.ru.is/h22/api/v1/login",{user:e,pass:f}).success(function(a){c=a.Token,d.username=a.User.Username,d.email=a.User.Email,d.fullName=a.User.FullName,d.ssn=a.User.SSN,d.role=a.User.Role;var b=new Array(c,d);g.resolve(b)}).error(function(){g.reject(status)}),g.promise},getToken:function(){return c},getUsername:function(){return d.username},getRole:function(){return d.role},getEmail:function(){return d.email},getFullName:function(){return d.fullName},getSSN:function(){return d.ssn},getUser:function(){return d}}}]),app.controller("AdminController",["$scope","$http","$location","LoginFactory",function(a,b,c,d){a.user=d.getUser(),a.test="test"}]),app.controller("EvaluationController",["$scope","ApiFactory","$routeParams",function(a,b,c){var d=c.evaluationID;void 0!==d?b.getEvaluationById(d).then(function(b){a.evaluation=b},function(a){console.log("Error fetching evaluation: "+a)}):a.evaluation={TitleIS:"",TitleEN:"",IntroTextIS:"",IntroTextEN:"",CourseQuestions:[],TeacherQuestions:[]},a.addAnswer=function(a){a.Answers.push("New answer")},a.addCourseQuestion=function(){a.evaluation.CourseQuestions.push({ID:a.evaluation.CourseQuestions.length,TextIS:"",TextEN:"",ImageURL:"",Type:"single",Answers:[]})}}]),app.controller("HomeController",["$scope","ApiFactory",function(a,b){b.getAllEvaluations().then(function(b){a.evaluations=b},function(){},function(){}),a.test="test"}]),app.controller("LoginController",["$scope","$http","$location","LoginFactory",function(a,b,c,d){var e,f={};a.login=function(){b.defaults.headers.common.Authorization="Basic "+d.getToken(),d.login(a.user.username,a.user.password).then(function(a){e=a[0],f=a[1],c.path("admin"===a[1].role?"/admin":"student"===a[1].role?"/home":"/")})},a.test="test"}]);